unnest_tokens(word, text) %>%
anti_join(stop_words) %>%
count(word, sort = TRUE) %>% ungroup() %>%
cast_sparse(docID, word, n)
# reorder dtm to sort rows by doc_num and cols by colsums
dtm1 = dtm1[order(as.numeric(rownames(dtm1))),]
b0 = apply(dtm1, 2, sum) %>% order(decreasing = TRUE)
dtm1 = dtm1[, b0]
})
system.time({
result <- FindTopicsNumber(
dtm1,
topics = seq(from = 2, to = 20, by = 1),
metrics = c("Griffiths2004", "CaoJuan2009", "Arun2010", "Deveaud2014"),
method = "Gibbs",
control = list(seed = 77),
mc.cores = 2L,
verbose = TRUE
)
})  # 28 seconds for nokia DS
result
FindTopicsNumber_plot(result)
View(dtm)
system.time({
result <- FindTopicsNumber(
dtm,
topics = seq(from = 2, to = 15, by = 1),
metrics = c("Griffiths2004", "CaoJuan2009", "Arun2010", "Deveaud2014"),
method = "Gibbs",
control = list(seed = 77),
mc.cores = 2L,
verbose = TRUE
)
})  # ~ 10 seconds
result
View(AssociatedPress)
View(dtm)
View(dtm)
View(result)
View(dtm)
View(AssociatedPress)
suppressPackageStartupMessages({
if (!require(ldatuning)) {install.packages("ldatuning")}
if (!require(topicmodels)) {install.packages("topicmodels")}
library("ldatuning")
library("topicmodels")
library(tidytext)
library(magrittr)
library(dplyr)
})
data("AssociatedPress", package="topicmodels")
dtm <- AssociatedPress[1:10, ]
dim(dtm)
system.time({
result <- FindTopicsNumber(
dtm,
topics = seq(from = 2, to = 15, by = 1),
metrics = c("Griffiths2004", "CaoJuan2009", "Arun2010", "Deveaud2014"),
method = "Gibbs",
control = list(seed = 77),
mc.cores = 2L,
verbose = TRUE
)
})  # ~ 10 seconds
result
FindTopicsNumber_plot(result)
require(dplyr)
# get nokia dataset
nokia = readLines('https://github.com/sudhir-voleti/sample-data-sets/raw/master/text%20analysis%20data/amazon%20nokia%20lumia%20reviews.txt')
library(tidytext)
text  = nokia # %>% clean_text(alphanum=TRUE)
textdf = data.frame(docID=seq(1:length(text)), text = text, stringsAsFactors=FALSE)
system.time({
dtm1 = textdf %>%
mutate(docID = row_number()) %>%    # row_number() is v useful.
group_by(docID) %>%
unnest_tokens(word, text) %>%
anti_join(stop_words) %>%
count(word, sort = TRUE) %>% ungroup() %>%
cast_sparse(docID, word, n)
# reorder dtm to sort rows by doc_num and cols by colsums
dtm1 = dtm1[order(as.numeric(rownames(dtm1))),]
b0 = apply(dtm1, 2, sum) %>% order(decreasing = TRUE)
dtm1 = dtm1[, b0]
})
system.time({
result <- FindTopicsNumber(
dtm1,
topics = seq(from = 2, to = 20, by = 1),
metrics = c("Griffiths2004", "CaoJuan2009", "Arun2010", "Deveaud2014"),
method = "Gibbs",
control = list(seed = 77),
mc.cores = 2L,
verbose = TRUE
)
})  # 28 seconds for nokia DS
result
FindTopicsNumber_plot(result)
View(dtm1)
View(textdf)
View(textdf)
seq(1:length(text))
text
length(text)
View(textdf)
library(tidyverse)
library(tidytext)
#setwd("C:\\Users\\31172\\TABA\\Session 3\\Session 3 Materials\\"); getwd()
# Consider 4 classics whose unlabeled chapters have been jumbled up.
titles <- c("Twenty Thousand Leagues under the Sea",
"The War of the Worlds",
"Pride and Prejudice",
"Great Expectations")
# using LTMs to reorganize the chapters
library(gutenbergr)
# system.time({
books <- gutenberg_works(title %in% titles) %>%
gutenberg_download(meta_fields = "title")
# })  # 5 secs
##  Alternately, read from disk directly as below
# saveRDS(books, "./books.Rds")
# books = readRDS("./books.Rds");  class(books)
books    # tibble: 51,663 x 3. cols = {gutenberg_id, text, title}
library(stringr)
# divide each book chapter into separate document.
by_chapter = books %>%
group_by(title) %>%
# detecting chapters using regex
mutate(chapter = cumsum(str_detect(text, regex("^chapter ", ignore_case = TRUE)))) %>%
ungroup() %>%
filter(chapter > 0) %>%
unite(document, title, chapter)
# split into words
by_chapter_word = by_chapter %>%
unnest_tokens(word, text)
# find document-word counts
word_counts = by_chapter_word %>%
anti_join(stop_words) %>%
count(document, word, sort = TRUE) %>%
ungroup()
word_counts    # A tibble: 104,722 x 3. cols = {doc, word, n}
# now cast into dtm
chapters_dtm = word_counts %>%
cast_dtm(document, word, n)
chapters_dtm   # DocumentTermMatrix (documents: 193, terms: 18215)
library(topicmodels)
system.time({
chapters_lda <- LDA(chapters_dtm, k = 4, control = list(seed = 1234))
})    # 30 secs
chapters_lda    # A LDA_VEM topic model with 4 topics
# examine per-topic-per-word probabilities.
chapter_topics = tidy(chapters_lda, matrix = "beta")
chapter_topics    # tibble: 72,860 x 3
str(chapter_topics)  # 3 colms. $topic, $term, $beta
# use dplyr's top_n() to find the top 5 terms within each topic.
top_terms = chapter_topics %>%
group_by(topic) %>%
top_n(5, beta) %>%
ungroup() %>%
arrange(topic, -beta)
top_terms    # # A tibble: 20 x 3
# Now visualize via ggplot
library(ggplot2)
top_terms %>%
mutate(term = reorder(term, beta)) %>%
ggplot(aes(term, beta, fill = factor(topic))) +
geom_col(show.legend = FALSE) +
facet_wrap(~ topic, scales = "free") +
coord_flip()
# Per-document classification
chapters_gamma = tidy(chapters_lda, matrix = "gamma")
chapters_gamma    # A tibble: 772 x 3
# re-separate the document name into title and chapter
chapters_gamma = chapters_gamma %>%
separate(document, c("title", "chapter"), sep = "_", convert = TRUE)
chapters_gamma    # A tibble: 772 x 4
# reorder titles in order of topic 1, topic 2, etc before box-plotting
chapters_gamma %>%
mutate(title = reorder(title, gamma * topic)) %>%
ggplot(aes(factor(topic), gamma)) +
geom_boxplot() +
facet_wrap(~ title)
# finding topic most associated with each chapter using max value, i.e., top_n(1)
chapter_classifications = chapters_gamma %>%
group_by(title, chapter) %>%
top_n(1, gamma) %>%
ungroup()
chapter_classifications    # A tibble: 193 x 4
book_topics = chapter_classifications %>%
count(title, topic) %>%
group_by(title) %>%
top_n(1, n) %>%
ungroup() %>%
transmute(consensus = title, topic)
book_topics    # A tibble: 4 x 2
# find 'em mismatches now.
chapter_classifications %>%
inner_join(book_topics, by = "topic") %>%
filter(title != consensus)
chapter_classifications    # A tibble: 2 x 5
## == By word assignments: augment() ==
# find which words in each document were assigned to which topic
assignments = augment(chapters_lda, data = chapters_dtm)
assignments    # tibble: 104,721 x 4. cols={doc, term, count, .topic}
# combine assignments table with consensus book titles to find incorrectly classified words.
assignments = assignments %>%
separate(document, c("title", "chapter"), sep = "_", convert = TRUE) %>%
inner_join(book_topics, by = c(".topic" = "topic"))
assignments   # tibble: 104,721 x 6. extra cols={title, chapter, consensus}
# visualize a confusion matrix for above misclassifications
assignments %>%
count(title, consensus, wt = count) %>%
group_by(title) %>%
mutate(percent = n / sum(n)) %>%
# now ggplot it
ggplot(aes(consensus, title, fill = percent)) +
geom_tile() +
scale_fill_gradient2(high = "red") +  # , label = percent_format()
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, hjust = 1),
panel.grid = element_blank()) +
labs(x = "Book words were assigned to",
y = "Book words came from",
fill = "% of assignments")
# What were the most commonly mistaken words?
wrong_words <- assignments %>%
filter(title != consensus)
wrong_words
library(tidyverse)
library(tidytext)
#setwd("C:\\Users\\31172\\TABA\\Session 3\\Session 3 Materials\\"); getwd()
# Consider 4 classics whose unlabeled chapters have been jumbled up.
titles <- c("Twenty Thousand Leagues under the Sea",
"The War of the Worlds",
"Pride and Prejudice",
"Great Expectations")
# using LTMs to reorganize the chapters
library(gutenbergr)
# system.time({
books <- gutenberg_works(title %in% titles) %>%
gutenberg_download(meta_fields = "title")
# })  # 5 secs
##  Alternately, read from disk directly as below
# saveRDS(books, "./books.Rds")
# books = readRDS("./books.Rds");  class(books)
books    # tibble: 51,663 x 3. cols = {gutenberg_id, text, title}
View(books)
knitr::opts_chunk$set(echo = TRUE)
require(openNLP)
if (!require(openNLP)) {install.packages("openNLP")}
require(openNLP)
if (!require(openNLP)) {install.packages("openNLP")}
require(openNLP)
if (!require(openNLP)) {install.packages("openNLP")}
require(openNLP)
text = "'Brexit (; a portmanteau of "British" and "exit") is the withdrawal of the United Kingdom (UK) from the European Union (EU). Following a referendum held on 23 June 2016 in which 51.9 percent of those voting supported leaving the EU, the Government invoked Article 50 of the Treaty on European Union, starting a two-year process which was due to conclude with the UK\'s exit on 29 March 2019—a deadline that has been extended to 31 October 2019.Withdrawal from the EU has been advocated by both left-wing and right-wing Eurosceptics, while pro-Europeanists, who also span the political spectrum, have advocated continued membership and maintaining the customs union and single market. The UK joined the European Communities (EC) in 1973 under the Conservative government of Edward Heath, with continued membership endorsed by a referendum in 1975. In the 1970s and 1980s, withdrawal from the EC was advocated mainly by the political left, with the Labour Party\'s 1983 election manifesto advocating full withdrawal. In 1987, the Single European Act, the first major revision of 1957\'s Treaty of Rome, formally established the single European market and European Political Cooperation.  From the 1990s, opposition to further European integration came mainly from the right. When in 1992 the Maastricht Treaty, which created the European Union (EU) and the single market and guaranteed the four basic freedoms (the free movement of goods, services, capital and people around the EU) was brought before Parliament, there were divisions within the Conservative Party, leading to a rebellion over the Treaty. The UK Independence Party (UKIP), formed in 1993, grew strongly in the early 2010s and the influence of the cross-party People\'s Pledge campaign has also been described as influential in bringing about a referendum. The Conservative Prime Minister, David Cameron, pledged during the campaign for the 2015 general election to hold a new referendum—a promise which he fulfilled in 2016 following pressure from the Eurosceptic wing of his party. Cameron, who had campaigned to remain, resigned after the result and was succeeded by Theresa May, his former Home Secretary. She called a snap general election less than a year later but lost her overall majority. Her minority government is supported in key votes by the Democratic Unionist Party.\nOn 29 March 2017, the Government of the United Kingdom invoked Article 50 of the Treaty on European Union. Theresa May announced the government\'s intention not to seek permanent membership of the European single market or the EU customs union after leaving the EU and promised to repeal the European Communities Act of 1972 and incorporate existing European Union law into UK domestic law. Negotiations with the EU officially started in June 2017. In November 2018, the Draft Withdrawal Agreement, negotiated between the UK Government and the EU, was published. The House of Commons voted against the agreement by a margin of 432 to 202 (the largest parliamentary defeat in history for a sitting UK government) on 15 January 2019, and again on 12 March with a margin of 391 to 242 against the agreement. On 14 March 2019, the House of Commons voted for the Prime Minister, Theresa May, to ask the EU for such an extension of the period allowed for the negotiation. Members from across the House of Commons rejected the agreement, with the leadership of the Labour Party stating in the House of Commons that any deal must maintain a customs union and single market, and with a large percentage of Conservative Party members rejecting the Irish backstop as it was drafted in the EU withdrawal agreement. Opponents of the EU Withdrawal Agreement expressed fears that the agreement as drafted could plunge Northern Ireland into a conflict and spark a return of The Troubles.\nThe broad consensus among economists is that Brexit will likely reduce the UK\'s real per capita income in the medium term and long term, and that the Brexit referendum itself damaged the economy. Studies on effects since the referendum show a reduction in GDP, trade and investment, as well as household losses from increased inflation. Brexit is likely to reduce immigration from European Economic Area (EEA) countries to the UK, and poses challenges for UK higher education and academic research. As of May 2019, the size of the "divorce bill"—the UK\'s inheritance of existing EU trade agreements—and relations with Ireland and other EU member states remains uncertain. The precise impact on the UK depends on whether the process will be a "hard" or "soft" Brexit.'
text = "'Brexit (; a portmanteau of "British" and "exit") is the withdrawal of the United Kingdom (UK) from the European Union (EU). Following a referendum held on 23 June 2016 in which 51.9 percent of those voting supported leaving the EU, the Government invoked Article 50 of the Treaty on European Union, starting a two-year process which was due to conclude with the UK\'s exit on 29 March 2019—a deadline that has been extended to 31 October 2019.Withdrawal from the EU has been advocated by both left-wing and right-wing Eurosceptics, while pro-Europeanists, who also span the political spectrum, have advocated continued membership and maintaining the customs union and single market. The UK joined the European Communities (EC) in 1973 under the Conservative government of Edward Heath, with continued membership endorsed by a referendum in 1975. In the 1970s and 1980s, withdrawal from the EC was advocated mainly by the political left, with the Labour Party\'s 1983 election manifesto advocating full withdrawal. In 1987, the Single European Act, the first major revision of 1957\'s Treaty of Rome, formally established the single European market and European Political Cooperation.  From the 1990s, opposition to further European integration came mainly from the right. When in 1992 the Maastricht Treaty, which created the European Union (EU) and the single market and guaranteed the four basic freedoms (the free movement of goods, services, capital and people around the EU) was brought before Parliament, there were divisions within the Conservative Party, leading to a rebellion over the Treaty. The UK Independence Party (UKIP), formed in 1993, grew strongly in the early 2010s and the influence of the cross-party People\'s Pledge campaign has also been described as influential in bringing about a referendum. The Conservative Prime Minister, David Cameron, pledged during the campaign for the 2015 general election to hold a new referendum—a promise which he fulfilled in 2016 following pressure from the Eurosceptic wing of his party. Cameron, who had campaigned to remain, resigned after the result and was succeeded by Theresa May, his former Home Secretary. She called a snap general election less than a year later but lost her overall majority. Her minority government is supported in key votes by the Democratic Unionist Party.\nOn 29 March 2017, the Government of the United Kingdom invoked Article 50 of the Treaty on European Union. Theresa May announced the government\'s intention not to seek permanent membership of the European single market or the EU customs union after leaving the EU and promised to repeal the European Communities Act of 1972 and incorporate existing European Union law into UK domestic law. Negotiations with the EU officially started in June 2017. In November 2018, the Draft Withdrawal Agreement, negotiated between the UK Government and the EU, was published. The House of Commons voted against the agreement by a margin of 432 to 202 (the largest parliamentary defeat in history for a sitting UK government) on 15 January 2019, and again on 12 March with a margin of 391 to 242 against the agreement. On 14 March 2019, the House of Commons voted for the Prime Minister, Theresa May, to ask the EU for such an extension of the period allowed for the negotiation. Members from across the House of Commons rejected the agreement, with the leadership of the Labour Party stating in the House of Commons that any deal must maintain a customs union and single market, and with a large percentage of Conservative Party members rejecting the Irish backstop as it was drafted in the EU withdrawal agreement. Opponents of the EU Withdrawal Agreement expressed fears that the agreement as drafted could plunge Northern Ireland into a conflict and spark a return of The Troubles.\nThe broad consensus among economists is that Brexit will likely reduce the UK\'s real per capita income in the medium term and long term, and that the Brexit referendum itself damaged the economy. Studies on effects since the referendum show a reduction in GDP, trade and investment, as well as household losses from increased inflation. Brexit is likely to reduce immigration from European Economic Area (EEA) countries to the UK, and poses challenges for UK higher education and academic research. As of May 2019, the size of the \"divorce bill\"—the UK\'s inheritance of existing EU trade agreements—and relations with Ireland and other EU member states remains uncertain. The precise impact on the UK depends on whether the process will be a \"hard\" or \"soft\" Brexit.'"
text = "'Brexit (; a portmanteau of \"British\" and \"exit\") is the withdrawal of the United Kingdom (UK) from the European Union (EU). Following a referendum held on 23 June 2016 in which 51.9 percent of those voting supported leaving the EU, the Government invoked Article 50 of the Treaty on European Union, starting a two-year process which was due to conclude with the UK\'s exit on 29 March 2019—a deadline that has been extended to 31 October 2019.Withdrawal from the EU has been advocated by both left-wing and right-wing Eurosceptics, while pro-Europeanists, who also span the political spectrum, have advocated continued membership and maintaining the customs union and single market. The UK joined the European Communities (EC) in 1973 under the Conservative government of Edward Heath, with continued membership endorsed by a referendum in 1975. In the 1970s and 1980s, withdrawal from the EC was advocated mainly by the political left, with the Labour Party\'s 1983 election manifesto advocating full withdrawal. In 1987, the Single European Act, the first major revision of 1957\'s Treaty of Rome, formally established the single European market and European Political Cooperation.  From the 1990s, opposition to further European integration came mainly from the right. When in 1992 the Maastricht Treaty, which created the European Union (EU) and the single market and guaranteed the four basic freedoms (the free movement of goods, services, capital and people around the EU) was brought before Parliament, there were divisions within the Conservative Party, leading to a rebellion over the Treaty. The UK Independence Party (UKIP), formed in 1993, grew strongly in the early 2010s and the influence of the cross-party People\'s Pledge campaign has also been described as influential in bringing about a referendum. The Conservative Prime Minister, David Cameron, pledged during the campaign for the 2015 general election to hold a new referendum—a promise which he fulfilled in 2016 following pressure from the Eurosceptic wing of his party. Cameron, who had campaigned to remain, resigned after the result and was succeeded by Theresa May, his former Home Secretary. She called a snap general election less than a year later but lost her overall majority. Her minority government is supported in key votes by the Democratic Unionist Party.\nOn 29 March 2017, the Government of the United Kingdom invoked Article 50 of the Treaty on European Union. Theresa May announced the government\'s intention not to seek permanent membership of the European single market or the EU customs union after leaving the EU and promised to repeal the European Communities Act of 1972 and incorporate existing European Union law into UK domestic law. Negotiations with the EU officially started in June 2017. In November 2018, the Draft Withdrawal Agreement, negotiated between the UK Government and the EU, was published. The House of Commons voted against the agreement by a margin of 432 to 202 (the largest parliamentary defeat in history for a sitting UK government) on 15 January 2019, and again on 12 March with a margin of 391 to 242 against the agreement. On 14 March 2019, the House of Commons voted for the Prime Minister, Theresa May, to ask the EU for such an extension of the period allowed for the negotiation. Members from across the House of Commons rejected the agreement, with the leadership of the Labour Party stating in the House of Commons that any deal must maintain a customs union and single market, and with a large percentage of Conservative Party members rejecting the Irish backstop as it was drafted in the EU withdrawal agreement. Opponents of the EU Withdrawal Agreement expressed fears that the agreement as drafted could plunge Northern Ireland into a conflict and spark a return of The Troubles.\nThe broad consensus among economists is that Brexit will likely reduce the UK\'s real per capita income in the medium term and long term, and that the Brexit referendum itself damaged the economy. Studies on effects since the referendum show a reduction in GDP, trade and investment, as well as household losses from increased inflation. Brexit is likely to reduce immigration from European Economic Area (EEA) countries to the UK, and poses challenges for UK higher education and academic research. As of May 2019, the size of the \"divorce bill\"—the UK\'s inheritance of existing EU trade agreements—and relations with Ireland and other EU member states remains uncertain. The precise impact on the UK depends on whether the process will be a \"hard\" or \"soft\" Brexit.'"
sentence_tokenizer <- Maxent_Sent_Token_Annotator(language = lang)
text <- as.String(text)  #convert text to string
sentence.boundaries <- annotate(text, sentence_tokenizer) #look for sentence boundaries
sentences <- text[sentence.boundaries]  #get sentences
text = "'Brexit (; a portmanteau of \"British\" and \"exit\") is the withdrawal of the United Kingdom (UK) from the European Union (EU). Following a referendum held on 23 June 2016 in which 51.9 percent of those voting supported leaving the EU, the Government invoked Article 50 of the Treaty on European Union, starting a two-year process which was due to conclude with the UK\'s exit on 29 March 2019—a deadline that has been extended to 31 October 2019.Withdrawal from the EU has been advocated by both left-wing and right-wing Eurosceptics, while pro-Europeanists, who also span the political spectrum, have advocated continued membership and maintaining the customs union and single market. The UK joined the European Communities (EC) in 1973 under the Conservative government of Edward Heath, with continued membership endorsed by a referendum in 1975. In the 1970s and 1980s, withdrawal from the EC was advocated mainly by the political left, with the Labour Party\'s 1983 election manifesto advocating full withdrawal. In 1987, the Single European Act, the first major revision of 1957\'s Treaty of Rome, formally established the single European market and European Political Cooperation.  From the 1990s, opposition to further European integration came mainly from the right. When in 1992 the Maastricht Treaty, which created the European Union (EU) and the single market and guaranteed the four basic freedoms (the free movement of goods, services, capital and people around the EU) was brought before Parliament, there were divisions within the Conservative Party, leading to a rebellion over the Treaty. The UK Independence Party (UKIP), formed in 1993, grew strongly in the early 2010s and the influence of the cross-party People\'s Pledge campaign has also been described as influential in bringing about a referendum. The Conservative Prime Minister, David Cameron, pledged during the campaign for the 2015 general election to hold a new referendum—a promise which he fulfilled in 2016 following pressure from the Eurosceptic wing of his party. Cameron, who had campaigned to remain, resigned after the result and was succeeded by Theresa May, his former Home Secretary. She called a snap general election less than a year later but lost her overall majority. Her minority government is supported in key votes by the Democratic Unionist Party.\nOn 29 March 2017, the Government of the United Kingdom invoked Article 50 of the Treaty on European Union. Theresa May announced the government\'s intention not to seek permanent membership of the European single market or the EU customs union after leaving the EU and promised to repeal the European Communities Act of 1972 and incorporate existing European Union law into UK domestic law. Negotiations with the EU officially started in June 2017. In November 2018, the Draft Withdrawal Agreement, negotiated between the UK Government and the EU, was published. The House of Commons voted against the agreement by a margin of 432 to 202 (the largest parliamentary defeat in history for a sitting UK government) on 15 January 2019, and again on 12 March with a margin of 391 to 242 against the agreement. On 14 March 2019, the House of Commons voted for the Prime Minister, Theresa May, to ask the EU for such an extension of the period allowed for the negotiation. Members from across the House of Commons rejected the agreement, with the leadership of the Labour Party stating in the House of Commons that any deal must maintain a customs union and single market, and with a large percentage of Conservative Party members rejecting the Irish backstop as it was drafted in the EU withdrawal agreement. Opponents of the EU Withdrawal Agreement expressed fears that the agreement as drafted could plunge Northern Ireland into a conflict and spark a return of The Troubles.\nThe broad consensus among economists is that Brexit will likely reduce the UK\'s real per capita income in the medium term and long term, and that the Brexit referendum itself damaged the economy. Studies on effects since the referendum show a reduction in GDP, trade and investment, as well as household losses from increased inflation. Brexit is likely to reduce immigration from European Economic Area (EEA) countries to the UK, and poses challenges for UK higher education and academic research. As of May 2019, the size of the \"divorce bill\"—the UK\'s inheritance of existing EU trade agreements—and relations with Ireland and other EU member states remains uncertain. The precise impact on the UK depends on whether the process will be a \"hard\" or \"soft\" Brexit.'"
if (!require(openNLP)) {install.packages("openNLP")}
if (!require(readtext)) {install.packages("readtext")}
require(openNLP)
library(readtext)
content <- readtext("brexit.txt")
View(content)
content <- readtext("brexit.txt").text
content <- readtext("brexit.txt") %>% text
content <- readLines("brexit.txt")
text <- readLines("brexit.txt")
sentence_tokenizer <- Maxent_Sent_Token_Annotator(language = lang)
if (!require(openNLP)) {install.packages("openNLP")}
if (!require(readtext)) {install.packages("readtext")}
require(openNLP)
require(tm)
require(NLP)
library(readtext)
sentence_tokenizer <- Maxent_Sent_Token_Annotator(language = lang)
sentence_tokenizer <- Maxent_Sent_Token_Annotator(language = "en")
text <- as.String(text)  #convert text to string
sentence.boundaries <- annotate(text, sentence_tokenizer) #look for sentence boundaries
sentences <- text[sentence.boundaries]  #get sentences
View(sentence.boundaries)
View(sentence.boundaries)
topics = ['brexit', 'Donald Trump', 'Game of Thrones', 'Bitcoin']
topics = c('brexit', 'Donald Trump', 'Game of Thrones', 'Bitcoin')
for (topic in topics)
print(topic)
topics = c('Brexit', 'Donald Trump', 'Game of Thrones', 'Bitcoin')
for (topic in topics)
print(topic)
topics = c('Brexit', 'Donald Trump', 'Game of Thrones', 'Bitcoin')
brexit <- readLines("brexit.txt")
trump <- readLines("Donald Trump.txt")
got <- readLines("Game of Thrones.txt")
bitcoin <- readLines("Bitcoin.txt")
View(by_chapter)
View(by_chapter)
View(books)
View(by_chapter_word)
topics = c('Brexit', 'Donald Trump', 'Game of Thrones', 'Bitcoin')
brexit <- readLines("brexit.txt",  warn = FALSE)
trump <- readLines("Donald Trump.txt")
got <- readLines("Game of Thrones.txt")
bitcoin <- readLines("Bitcoin.txt")
topics = c('Brexit', 'Donald Trump', 'Game of Thrones', 'Bitcoin')
brexit <- readLines("brexit.txt", warn = FALSE)
trump <- readLines("Donald Trump.txt", warn = FALSE)
got <- readLines("Game of Thrones.txt", warn = FALSE)
bitcoin <- readLines("Bitcoin.txt", warn = FALSE)
print(brexit[1])
print(brexit[2])
print(length(brexit))
print(length(trump))
print(length(got))
print(length(bitcoin))
print(bitcoin[238])
print(bitcoin[239])
print(bitcoin[0])
print(bitcoin[1])
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files,readLines)
docs <- Corpus(VectorSource(files))
View(docs)
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files,readLines)
docs <- Corpus(VectorSource(files))
writeLines(as.character(docs[[30]]))
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files,readLines)
docs <- Corpus(VectorSource(files))
writeLines(as.character(docs[[4]]))
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files,readLines)
docs <- Corpus(VectorSource(files))
writeLines(as.character(docs[[4]]))
dtm <- DocumentTermMatrix(docs)
View(dtm)
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files,readLines)
docs <- Corpus(VectorSource(files))
#writeLines(as.character(docs[[4]]))
dtm <- DocumentTermMatrix(docs)
rownames(dtm) <- filenames
rownames(dtm) <- wiki_files
#collapse matrix by summing over columns
freq <- colSums(as.matrix(dtm))
#length should be total number of terms
length(freq)
#create sort order (descending)
ord <- order(freq,decreasing=TRUE)
#List all terms in decreasing order of freq and write to disk
freq[ord]
#Run LDA using Gibbs sampling
ldaOut <-LDA(dtm,4, method=”Gibbs”, control=list(nstart=nstart, seed = seed, best=best, burnin = burnin, iter = iter, thin=thin))
#Run LDA using Gibbs sampling
ldaOut <-LDA(dtm,4, method="Gibbs", control=list(nstart=nstart, seed = seed, best=best, burnin = burnin, iter = iter, thin=thin))
library(topicmodels)
#Run LDA using Gibbs sampling
ldaOut <-LDA(dtm,4, method="Gibbs", control=list(nstart=nstart, seed = seed, best=best, burnin = burnin, iter = iter, thin=thin))
library(topicmodels)
burnin <- 4000
iter <- 2000
thin <- 500
seed <-list(2003,5,63,100001,765)
nstart <- 5
best <- TRUE
#Run LDA using Gibbs sampling
ldaOut <-LDA(dtm,4, method="Gibbs", control=list(nstart=nstart, seed = seed, best=best, burnin = burnin, iter = iter, thin=thin))
ldaOut.topics <- as.matrix(topics(ldaOut))
View(ldaOut.topics)
ldaOut.topics <- as.matrix(topics(ldaOut))
ldaOut.terms <- as.matrix(terms(ldaOut,6))
View(ldaOut.terms)
ldaOut.topics <- as.matrix(topics(ldaOut))
ldaOut.terms <- as.matrix(terms(ldaOut,6))
topicProbabilities <- as.data.frame(ldaOut@gamma)
View(ldaOut.topics)
View(topicProbabilities)
View(files)
View(dtm1)
ldaOut.topics <- as.matrix(topics(ldaOut))
ldaOut.terms <- as.matrix(terms(ldaOut,6))
topicProbabilities <- as.data.frame(ldaOut@gamma)
View(ldaOut.topics)
View(ldaOut.terms)
View(files)
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines)
for (file in files) {
sentences <- get_sentences_from_corpus(file)
print(sentences)
}
get_sentences_from_corpus <- function(text, lang = "en") {
#use openNLP sentence tokenizer
sentence_tokenizer <- Maxent_Sent_Token_Annotator(language = lang)
text <- as.String(text)  #convert text to string
sentence_list <- annotate(text, sentence_tokenizer) #look for sentence boundaries
sentences <- text[sentence_list]  #get sentences
# return sentences
return(sentences)
}
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines)
for (file in files) {
sentences <- get_sentences_from_corpus(file)
print(sentences)
}
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines)
for (file in files) {
sentences <- get_sentences_from_corpus(file)
df <- data.frame(matrix(unlist(sentences), nrow=length(sentences), byrow=T))
head(df)
}
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines)
for (file in files) {
sentences <- get_sentences_from_corpus(file)
df <- data.frame(matrix(unlist(sentences), nrow=length(sentences), byrow=T))
print(df)
}
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines)
i <- 1
for (file in files) {
sentences <- get_sentences_from_corpus(file)
df <- data.frame(matrix(unlist(sentences), nrow=length(sentences), byrow=T), stringsAsFactors=FALSE)
df['Category'] <- wiki_files[i]
print(df)
i++
}
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines)
i <- 1
for (file in files) {
sentences <- get_sentences_from_corpus(file)
df <- data.frame(matrix(unlist(sentences), nrow=length(sentences), byrow=T), stringsAsFactors=FALSE)
df['Category'] <- wiki_files[i]
print(df)
i <- i+1
}
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines)
master_df <- data.frame()
i <- 1
for (file in files) {
sentences <- get_sentences_from_corpus(file)
df <- data.frame(matrix(unlist(sentences), nrow=length(sentences), byrow=T), stringsAsFactors=FALSE)
df['Category'] <- wiki_files[i]
master_df <- master_df.append(df, ignore_index = True)
i <- i+1
}
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines)
master_df <- data.frame()
i <- 1
for (file in files) {
sentences <- get_sentences_from_corpus(file)
df <- data.frame(matrix(unlist(sentences), nrow=length(sentences), byrow=T), stringsAsFactors=FALSE)
df['Category'] <- wiki_files[i]
master_df <- rbind(master_df, df)
i <- i+1
}
View(master_df)
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines)
master_df <- data.frame()
i <- 1
for (file in files) {
sentences <- get_sentences_from_corpus(file)
df <- data.frame(matrix(unlist(sentences), nrow=length(sentences), byrow=T), stringsAsFactors=FALSE)
df['Category'] <- wiki_files[i]
master_df <- rbind(master_df, df)
i <- i+1
}
df <- master_df[sample(nrow(master_df)),]
View(df)
View(df)
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines)
master_df <- data.frame()
i <- 1
for (file in files) {
sentences <- get_sentences_from_corpus(file)
df <- data.frame(matrix(unlist(sentences), nrow=length(sentences), byrow=T), stringsAsFactors=FALSE)
df['Category'] <- wiki_files[i]
master_df <- rbind(master_df, df)
i <- i+1
}
df <- master_df[sample(nrow(master_df)),]
df$doc_id <- cut(df$Category, wiki_files, c(1,2,3,4))
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines)
master_df <- data.frame()
i <- 1
for (file in files) {
sentences <- get_sentences_from_corpus(file)
df <- data.frame(matrix(unlist(sentences), nrow=length(sentences), byrow=T), stringsAsFactors=FALSE)
df['Category'] <- wiki_files[i]
master_df <- rbind(master_df, df)
i <- i+1
}
df <- master_df[sample(nrow(master_df)),]
df$doc_id <- ifelse(df$Category == "Brexit.txt", 1,
ifelse(df$Category == "Donald Trump.txt", 2,
ifelse(df$Category == "Game of Thrones.txt", 3, 4)))
wiki_files = c('Brexit.txt', 'Donald Trump.txt', 'Game of Thrones.txt', 'Bitcoin.txt')
files <- lapply(wiki_files, readLines(warn = FALSE))

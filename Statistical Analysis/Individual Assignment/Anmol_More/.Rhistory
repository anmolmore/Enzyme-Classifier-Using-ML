house_prices <- read.csv('houseprices.csv')
#set of old and new houses
old_houses <- subset(house_prices, house_prices$Age > 30)
new_houses <- subset(house_prices, house_prices$Age <= 30)
#set of old and new houses with fireplace
new_houses_with_fireplace <- subset(house_prices, house_prices$Age <= 30 & house_prices$Fireplace == 1)
old_houses_with_fireplace <- subset(house_prices, house_prices$Age > 30 & house_prices$Fireplace == 1)
n_nf <- nrow(new_houses_with_fireplace)
n_of <- nrow(old_houses_with_fireplace)
p_nf <- nrow(new_houses_with_fireplace)/nrow(new_houses)
p_of <- nrow(old_houses_with_fireplace)/nrow(old_houses)
p_bar <- (p_nf*n_nf + p_of*n_of) / (n_nf + n_of)
print(paste0("Sample pooled proportion :",p_bar))
z <- (p_nf - p_of) / sqrt(p_bar*(1-p_bar)*(1/n_nf + 1/n_of))
print(paste0("z :",z))
p_value <- 1 - pnorm(z)
print(paste0("p value :",p_value))
#Let, p_nf be proportion of new houses with fireplace and p_of be proportion of old houses with fireplace
#null hypothesis, H_0 : p_nf - p_of < 0
#alternate hypothesis, H_a : p_nf - p_of > 0
house_prices <- read.csv('houseprices.csv')
#set of old and new houses
old_houses <- subset(house_prices, house_prices$Age > 30)
new_houses <- subset(house_prices, house_prices$Age <= 30)
#set of old and new houses with fireplace
new_houses_with_fireplace <- subset(house_prices, house_prices$Age <= 30 & house_prices$Fireplace == 1)
old_houses_with_fireplace <- subset(house_prices, house_prices$Age > 30 & house_prices$Fireplace == 1)
n_nf <- nrow(new_houses_with_fireplace)
n_of <- nrow(old_houses_with_fireplace)
p_nf <- nrow(new_houses_with_fireplace)/nrow(new_houses)
p_of <- nrow(old_houses_with_fireplace)/nrow(old_houses)
print(p_nf)
print(p_of)
p_bar <- (p_nf*n_nf + p_of*n_of) / (n_nf + n_of)
print(paste0("Sample pooled proportion :",p_bar))
z <- (p_nf - p_of) / sqrt(p_bar*(1-p_bar)*(1/n_nf + 1/n_of))
print(paste0("z :",z))
p_value <- 1 - pnorm(z)
print(paste0("p value :",p_value))
#Let, p_nf be proportion of new houses with fireplace and p_of be proportion of old houses with fireplace
#null hypothesis, H_0 : p_nf - p_of < 0
#alternate hypothesis, H_a : p_nf - p_of > 0
house_prices <- read.csv('houseprices.csv')
#set of old and new houses
old_houses <- subset(house_prices, house_prices$Age > 30)
new_houses <- subset(house_prices, house_prices$Age <= 30)
#set of old and new houses with fireplace
new_houses_with_fireplace <- subset(house_prices, house_prices$Age <= 30 & house_prices$Fireplace == 1)
old_houses_with_fireplace <- subset(house_prices, house_prices$Age > 30 & house_prices$Fireplace == 1)
n_nf <- nrow(new_houses_with_fireplace)
n_of <- nrow(old_houses_with_fireplace)
print(n_nf)
print(n_of)
p_nf <- nrow(new_houses_with_fireplace)/nrow(new_houses)
p_of <- nrow(old_houses_with_fireplace)/nrow(old_houses)
print(p_nf)
print(p_of)
p_bar <- (p_nf*n_nf + p_of*n_of) / (n_nf + n_of)
print(paste0("Sample pooled proportion :",p_bar))
z <- (p_nf - p_of) / sqrt(p_bar*(1-p_bar)*(1/n_nf + 1/n_of))
print(paste0("z :",z))
p_value <- 1 - pnorm(z)
print(paste0("p value :",p_value))
#Let, p_nf be proportion of new houses with fireplace and p_of be proportion of old houses with fireplace
#null hypothesis, H_0 : p_nf - p_of < 0
#alternate hypothesis, H_a : p_nf - p_of > 0
house_prices <- read.csv('houseprices.csv')
#set of old and new houses
old_houses <- subset(house_prices, house_prices$Age > 30)
new_houses <- subset(house_prices, house_prices$Age <= 30)
#set of old and new houses with fireplace
new_houses_with_fireplace <- subset(house_prices, house_prices$Age <= 30 & house_prices$Fireplace == 1)
old_houses_with_fireplace <- subset(house_prices, house_prices$Age > 30 & house_prices$Fireplace == 1)
n_nf <- nrow(new_houses_with_fireplace)
n_of <- nrow(old_houses_with_fireplace)
print(new_houses)
print(old_houses)
print(n_nf)
print(n_of)
p_nf <- nrow(new_houses_with_fireplace)/nrow(new_houses)
p_of <- nrow(old_houses_with_fireplace)/nrow(old_houses)
print(p_nf)
print(p_of)
p_bar <- (p_nf*n_nf + p_of*n_of) / (n_nf + n_of)
print(paste0("Sample pooled proportion :",p_bar))
z <- (p_nf - p_of) / sqrt(p_bar*(1-p_bar)*(1/n_nf + 1/n_of))
print(paste0("z :",z))
p_value <- 1 - pnorm(z)
print(paste0("p value :",p_value))
#Let, p_nf be proportion of new houses with fireplace and p_of be proportion of old houses with fireplace
#null hypothesis, H_0 : p_nf - p_of < 0
#alternate hypothesis, H_a : p_nf - p_of > 0
house_prices <- read.csv('houseprices.csv')
#set of old and new houses
old_houses <- subset(house_prices, house_prices$Age > 30)
new_houses <- subset(house_prices, house_prices$Age <= 30)
#set of old and new houses with fireplace
new_houses_with_fireplace <- subset(house_prices, house_prices$Age <= 30 & house_prices$Fireplace == 1)
old_houses_with_fireplace <- subset(house_prices, house_prices$Age > 30 & house_prices$Fireplace == 1)
n_nf <- nrow(new_houses_with_fireplace)
n_of <- nrow(old_houses_with_fireplace)
print(nrow(new_houses))
print(nrow(old_houses))
print(n_nf)
print(n_of)
p_nf <- nrow(new_houses_with_fireplace)/nrow(new_houses)
p_of <- nrow(old_houses_with_fireplace)/nrow(old_houses)
print(p_nf)
print(p_of)
p_bar <- (p_nf*n_nf + p_of*n_of) / (n_nf + n_of)
print(paste0("Sample pooled proportion :",p_bar))
z <- (p_nf - p_of) / sqrt(p_bar*(1-p_bar)*(1/n_nf + 1/n_of))
print(paste0("z :",z))
p_value <- 1 - pnorm(z)
print(paste0("p value :",p_value))
